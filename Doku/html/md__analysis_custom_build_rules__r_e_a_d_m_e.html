<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Analysis: How to setup custom build rules for Visual Studio 2010 and up.</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Analysis
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__analysis_custom_build_rules__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">How to setup custom build rules for Visual Studio 2010 and up. </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>First of all you should have the necessary files. Custom Build rules are separated into a file triplet of <code>.xml</code>, <code>.targets</code> and <code>.props</code>.</p>
<p>You find the custom build rules for win_flex_bison in the <b>custom_build_rules</b> directory of the win_flex_bison archive.</p>
<p>You may choose to install one of the following rule set</p>
<ul>
<li>the combined rules - <a href="https://sourceforge.net/projects/winflexbison/files/win_flex_bison_custom_build_rules.zip/download" title="Combined build rules for Bison and Flex">alternative download</a>:<ul>
<li><a href="win_flex_bison/win_flex_bison_custom_build.props">win_flex_bison_custom_build.props</a></li>
<li><a href="win_flex_bison/win_flex_bison_custom_build.targets">win_flex_bison_custom_build.targets</a></li>
<li><a href="win_flex_bison/win_flex_bison_custom_build.xml">win_flex_bison_custom_build.xml</a></li>
</ul>
</li>
<li>flex only rules - <a href="https://sourceforge.net/projects/winflexbison/files/win_flex_custom_build_rules.zip/download" title="Build rules for Flex only">alternative download</a>:<ul>
<li><a href="win_flex_only/win_flex_custom_build.props">win_flex_custom_build.props</a></li>
<li><a href="win_flex_only/win_flex_custom_build.targets">win_flex_custom_build.targets</a></li>
<li><a href="win_flex_only/win_flex_custom_build.xml">win_flex_custom_build.xml</a></li>
</ul>
</li>
<li>bison only rules - <a href="https://sourceforge.net/projects/winflexbison/files/win_bison_custom_build_rules.zip/download" title="Build rules for Bison only">alternative download</a>:<ul>
<li><a href="win_bison_only/win_bison_custom_build.props">win_bison_custom_build.props</a></li>
<li><a href="win_bison_only/win_bison_custom_build.targets">win_bison_custom_build.targets</a></li>
<li><a href="win_bison_only/win_bison_custom_build.xml">win_bison_custom_build.xml</a></li>
</ul>
</li>
</ul>
<p>This documentation uses the combined rule-set but can be used for all rule-sets.</p>
<hr  />
<p>Launch Visual Studio and open an VC/VC++ project. Open context menu for project item in Solution Explorer panel and select "**Build Customizations...**" menu item. (Note: newer VS versions have this below sub-menu "**Build Dependencies...**".)</p>
<p><img src="docs/1.png" alt="Build Customizations in Solution Explorer" class="inline"/></p>
<hr  />
<p>In popup dialog "Visual C++ Build Customization Files" press "**Find Existing...**" button.</p>
<p><img src="docs/2.png" alt="Customization Files" class="inline"/></p>
<hr  />
<p>In Open File dialog select "**win_flex_bison_custom_build.targets**" file and press "Open". (Note: you may have to switch the file filter to "(*.*) all files".)</p>
<hr  />
<p>You will see "Add Search Path?" message box, press "Yes".</p>
<p><img src="docs/3.png" alt="Adding Search Path" class="inline"/></p>
<hr  />
<p>In "Visual C++ Build Customization Files" dialog check just added item <b>win_flex_bison_custom_build</b> and press "OK".</p>
<p><img src="docs/4.png" alt="activate custom build rule" class="inline"/></p>
<hr  />
<p>Now you can add flex and bison files to the project...</p>
<p><img src="docs/5.png" alt="project with flex and bison files added" class="inline"/></p>
<p>... and build. In build output you should see something like this:</p>
<div class="fragment"><div class="line">1&gt;------ Rebuild All started: Project: ConsoleApplication1, Configuration: Debug Win32 ------</div>
<div class="line">1&gt;  Process sample bison file</div>
<div class="line">1&gt;  Process sample flex file</div>
<div class="line">1&gt;  stdafx.cpp</div>
<div class="line">1&gt;  ConsoleApplication1.cpp</div>
<div class="line">1&gt;  Generating Code...</div>
<div class="line">1&gt;  ConsoleApplication1.vcxproj -&gt; C:\Users\ConsoleApplication1\Debug\ConsoleApplication1.exe</div>
<div class="line">========== Rebuild All: 1 succeeded, 0 failed, 0 skipped ==========</div>
</div><!-- fragment --><hr  />
<p>For <b>sample.y</b> bison file there are two output files: <b>sample.tab.h</b> and <b>sample.tab.cpp</b>. For <b>sample.l</b> flex file you'll got <b>sample.flex.cpp</b>.</p>
<p>Now you can add them to the project and build. (<em>Don't forget to exclude cpp files from using precompiled headers</em>)</p>
<p><img src="docs/6.png" alt="Include generated files into Solution" class="inline"/></p>
<div class="fragment"><div class="line">1&gt;------ Build started: Project: ConsoleApplication1, Configuration: Debug Win32 ------</div>
<div class="line">1&gt;  Process sample bison file</div>
<div class="line">1&gt;  Process sample flex file</div>
<div class="line">1&gt;  sample.tab.cpp</div>
<div class="line">1&gt;  sample.flex.cpp</div>
<div class="line">1&gt;  Generating Code...</div>
<div class="line">1&gt;  ConsoleApplication1.vcxproj -&gt; C:\Users\ConsoleApplication1\Debug\ConsoleApplication1.exe</div>
<div class="line">========== Build: 1 succeeded, 0 failed, 0 up-to-date, 0 skipped ==========</div>
</div><!-- fragment --><hr  />
<p>If your flex/bison file is incorrect and you've got an error. But you don't see actual error message, something like this:</p>
<div class="fragment"><div class="line">1&gt;------ Build started: Project: ConsoleApplication2, Configuration: Debug Win32 ------</div>
<div class="line">1&gt;  Process &quot;grammar.y&quot; bison file</div>
<div class="line">1&gt;C:...\custom_build_rules\win_flex_bison_custom_build.targets(55,5): error MSB3721: The command &quot;</div>
<div class="line">1&gt;C:...\custom_build_rules\win_flex_bison_custom_build.targets(55,5): error MSB3721: start /B /WAIT /D &quot;C:...\ConsoleApplication2\ConsoleApplication2\&quot; win_bison.exe --output=&quot;grammar.tab.cpp&quot; --defines=&quot;grammar.tab.h&quot; --graph=&quot;1.dot&quot; &quot;grammar.y&quot;</div>
<div class="line">1&gt;C:...\custom_build_rules\win_flex_bison_custom_build.targets(55,5): error MSB3721: exit /b %errorlevel%&quot; exited with code 1.</div>
<div class="line">========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ==========</div>
</div><!-- fragment --><p>You can change Build Output Verbosity from "Minimal" to "Normal" in "Options" dialog</p>
<p><img src="docs/Verbosity.png" alt="Verbosity" class="inline"/></p>
<p>Then you will see more detailed output:</p>
<div class="fragment"><div class="line">1&gt;BisonTarget:</div>
<div class="line">1&gt;  Process &quot;grammar.y&quot; bison file</div>
<div class="line">1&gt;  grammar.y:51.1-4: error: invalid directive: &#39;%sdw&#39;</div>
<div class="line">1&gt;C:...\custom_build_rules\win_flex_bison_custom_build.targets(55,5): error MSB3721: The command &quot;</div>
<div class="line">1&gt;C:...\custom_build_rules\win_flex_bison_custom_build.targets(55,5): error MSB3721: start /B /WAIT /D &quot;C:...\ConsoleApplication2\&quot; win_bison.exe --output=&quot;grammar.tab.cpp&quot; --defines=&quot;grammar.tab.h&quot; --graph=&quot;1.dot&quot; &quot;grammar.y&quot;</div>
<div class="line">1&gt;C:...\custom_build_rules\win_flex_bison_custom_build.targets(55,5): error MSB3721: exit /b %errorlevel%&quot; exited with code 1.</div>
<div class="line">1&gt;</div>
<div class="line">1&gt;Build FAILED.</div>
<div class="line">1&gt;</div>
<div class="line">1&gt;Time Elapsed 00:00:01.21</div>
<div class="line">========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ==========</div>
</div><!-- fragment --><hr  />
<p>Also you can tune some flex/bison options in files properties dialog:</p>
<p><img src="docs/Properties.png" alt="Opening File Properties" class="inline"/> <img src="docs/FlexProperties.png" alt="Property Page for Flex sources" class="inline"/> <img src="docs/BisonProperties.png" alt="Property Page for Bison sources" class="inline"/></p>
<hr  />
<p>To debug your scanner or parser you can set break points right into <b>sample.y</b> or <b>sample.l</b> code.</p>
<p><img src="docs/Flex_debuging.png" alt="Debugging Flex source files" class="inline"/></p>
<hr  />
<p>To use the Visual C++ Code editor for Flex/Bison files instead of the text editor adjust your editor settings as follows:</p>
<ul>
<li>click <b>Options</b> on the <b>Tools</b> menu, expand the <b>Text Editor</b> node and select <b>File Extension</b></li>
<li>type extension **<code>l</code>** in the <b>Extension</b> field and choose <b>Microsoft Visual C++</b> in the <b>Editor</b> drop-down field, click <b>Add</b></li>
<li>do the same for the extension **<code>y</code>**</li>
</ul>
<p>You now have syntax highlighting, code-completion and show definition options in your Flex/Bison source.</p>
<hr  />
<p>Enjoy! </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
